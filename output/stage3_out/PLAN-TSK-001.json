{
  "plan_id": "PLAN-TSK-001",
  "selected_task_id": "TSK-001",
  "goal": "Predict Indian rice exports to Bangladesh using domestic production metrics",
  "task_category": "predictive",
  "created_at": "2025-12-01T13:51:13.148551",
  "created_by": "stage3_agent",
  "artifacts": {
    "intermediate_table": "TSK-001_data.parquet",
    "intermediate_format": "parquet",
    "expected_columns": [
      "Year",
      "Value (INR)_export",
      "Production-2020-21",
      "Production-2021-22",
      "Production-2022-23",
      "Production-2023-24",
      "Production-2024-25",
      "Yield-2020-21",
      "Yield-2021-22",
      "Yield-2022-23",
      "Yield-2023-24",
      "Yield-2024-25"
    ],
    "expected_row_count_range": [
      5,
      8
    ]
  },
  "key_normalization": [
    {
      "column_name": "Year",
      "mapping": {
        "2020 - 21": "2020-21",
        "2021 - 22": "2021-22",
        "2022 - 23": "2022-23",
        "2023 - 24": "2023-24",
        "2024 - 25": "2024-25"
      },
      "format_type": "YYYY-YY",
      "valid_range": [
        2020,
        2025
      ]
    }
  ],
  "file_instructions": [
    {
      "file_id": "FILE-EXPORT",
      "original_name": "Export-of-Rice-Varieties-to-Bangladesh,-2018-19-to-2024-25.csv",
      "alias": "export",
      "filters": [
        "Crop == 'Rice'"
      ],
      "rename_columns": {
        "Description": "Crop"
      },
      "join_keys": [
        "Year"
      ],
      "keep_columns": [
        "Crop",
        "2020 - 21-Value (INR)",
        "2021 - 22-Value (INR)",
        "2022 - 23-Value (INR)",
        "2023 - 24-Value (INR)",
        "2024 - 25-Value (INR)"
      ],
      "notes": "Melt wide year columns to long format, extract Year from column names"
    },
    {
      "file_id": "FILE-PRODUCTION",
      "original_name": "All-India-Estimates-of-Area,-Production-&-Yield-of-Food-Grains.csv",
      "alias": "production",
      "filters": [
        "Crop == 'Rice' and Season == 'Total'"
      ],
      "rename_columns": {},
      "join_keys": [
        "Year"
      ],
      "keep_columns": [
        "Crop",
        "Season",
        "Production-2020-21",
        "Production-2021-22",
        "Production-2022-23",
        "Production-2023-24",
        "Production-2024-25",
        "Yield-2020-21",
        "Yield-2021-22",
        "Yield-2022-23",
        "Yield-2023-24",
        "Yield-2024-25"
      ],
      "notes": "Use Total season for annual aggregation"
    }
  ],
  "join_steps": [
    {
      "step": 1,
      "description": "Load base export table",
      "left_table": "export",
      "right_table": null,
      "join_type": "base",
      "join_keys": [],
      "left_on": [],
      "right_on": [],
      "expected_cardinality": "base",
      "validation": {
        "check_duplicates_on_keys": [],
        "expected_unique": false,
        "check_row_count_stable": false,
        "check_no_duplicates_introduced": false,
        "acceptable_coverage": null,
        "max_cardinality_ratio": null
      }
    },
    {
      "step": 2,
      "description": "Join with production data on Year",
      "left_table": "export",
      "right_table": "production",
      "join_type": "inner",
      "join_keys": [
        "Year"
      ],
      "left_on": [
        "Year"
      ],
      "right_on": [
        "Year"
      ],
      "expected_cardinality": "1:1",
      "validation": {
        "check_duplicates_on_keys": [],
        "expected_unique": false,
        "check_row_count_stable": false,
        "check_no_duplicates_introduced": false,
        "acceptable_coverage": null,
        "max_cardinality_ratio": null
      }
    }
  ],
  "feature_engineering": [
    {
      "feature_name": "Value (INR)_export",
      "description": "Target variable - annual rice export value to Bangladesh",
      "transform": "identity",
      "depends_on": [
        "2020 - 21-Value (INR)",
        "2021 - 22-Value (INR)",
        "2022 - 23-Value (INR)",
        "2023 - 24-Value (INR)",
        "2024 - 25-Value (INR)"
      ],
      "implementation": "df.melt(id_vars=['Crop'], value_vars=['2020 - 21-Value (INR)', '2021 - 22-Value (INR)', '2022 - 23-Value (INR)', '2023 - 24-Value (INR)', '2024 - 25-Value (INR)'], var_name='Year', value_name='Value (INR)_export')"
    },
    {
      "feature_name": "Lagged_Production",
      "description": "Lagged production metrics for time alignment",
      "transform": "lag",
      "depends_on": [
        "Production-2020-21",
        "Production-2021-22",
        "Production-2022-23",
        "Production-2023-24"
      ],
      "implementation": "df['Lagged_Production'] = df[['Production-2020-21', 'Production-2021-22', 'Production-2022-23', 'Production-2023-24']].shift(1)"
    }
  ],
  "validation": {
    "time_split": {
      "method": "year-based",
      "train_years": "2020-21 to 2023-24",
      "test_years": "2024-25",
      "validation_years": null,
      "leakage_check": "Use forward-fill for historical production data"
    },
    "coverage_checks": [
      {
        "check": "Target coverage",
        "threshold": 0.65,
        "description": "Verify ≥65% non-null values in Value (INR)_export",
        "action_if_violation": "Drop records with missing target"
      },
      {
        "check": "Feature coverage",
        "threshold": 0.65,
        "description": "Verify ≥65% non-null values in production/yield features",
        "action_if_violation": "Forward-fill missing values"
      }
    ],
    "cardinality_checks": [
      {
        "check": "Unique years",
        "expected": "unique",
        "action_if_violation": "Drop duplicate year entries"
      }
    ],
    "additional_checks": [
      "Confirm INR currency preference",
      "Validate temporal alignment between production and export cycles"
    ]
  },
  "expected_model_types": [
    "Regression",
    "Time Series"
  ],
  "evaluation_metrics": [
    "RMSE",
    "R2"
  ],
  "notes": [
    "Use INR values per currency preference",
    "Map all export descriptions to 'Rice' category",
    "Forward-fill missing production data as per handling_missingness"
  ]
}