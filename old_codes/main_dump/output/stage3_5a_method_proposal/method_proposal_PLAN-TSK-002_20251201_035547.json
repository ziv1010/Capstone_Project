{
  "plan_id": "PLAN-TSK-002",
  "task_category": "predictive",
  "methods_proposed": [
    {
      "method_id": "METHOD-1",
      "name": "Moving Average Baseline",
      "description": "3-year moving average of production values for baseline forecasting",
      "implementation_code": "import pandas as pd\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\n\n# Load data\ndf = pd.read_parquet('/scratch/ziv_baretto/llmserve/final_code/output/stage3b_data_prep/prepared_PLAN-TSK-002.parquet')\n\n# Discover target and date columns\ntarget_col = 'Production-2024-25'\nseason_col = 'Season'\n\n# Split data based on year in column names\ntrain_df = df[[col for col in df.columns if 'Production' in col and int(col.split('-')[1].split('-')[0]) <= 2023]]\ntrain_df['Prediction'] = train_df.mean(axis=1)\n\n# Calculate metrics\nmae = mean_absolute_error(df[target_col], train_df['Prediction'])\nrmse = mean_squared_error(df[target_col], train_df['Prediction'], squared=False)\n\nprint(f\"MAE: {mae}\")\nprint(f\"RMSE: {rmse}\")",
      "libraries_required": [
        "pandas",
        "scikit-learn"
      ]
    },
    {
      "method_id": "METHOD-2",
      "name": "ARIMA Time Series Model",
      "description": "Seasonal ARIMA model capturing production trends and seasonality patterns",
      "implementation_code": "import pandas as pd\nfrom statsmodels.tsa.arima.model import ARIMA\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\n\n# Load data\ndf = pd.read_parquet('/scratch/ziv_baretto/llmserve/final_code/output/stage3b_data_prep/prepared_PLAN-TSK-002.parquet')\n\n# Prepare time series data\ntime_series = df['Production-2024-25'].values\n\n# Split data (80% train, 20% test)\ntrain_size = int(len(time_series) * 0.8)\ntrain, test = time_series[:train_size], time_series[train_size:]\n\n# Train ARIMA model\nmodel = ARIMA(train, order=(2,1,2))\nresults = model.fit()\n\n# Forecast\nforecast = results.forecast(steps=len(test))\n\n# Calculate metrics\nmae = mean_absolute_error(test, forecast)\nrmse = mean_squared_error(test, forecast, squared=False)\n\nprint(f\"MAE: {mae}\")\nprint(f\"RMSE: {rmse}\")",
      "libraries_required": [
        "pandas",
        "statsmodels",
        "scikit-learn"
      ]
    },
    {
      "method_id": "METHOD-3",
      "name": "Random Forest Regressor",
      "description": "Tree-based model using engineered features and historical production data",
      "implementation_code": "import pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\n\n# Load data\ndf = pd.read_parquet('/scratch/ziv_baretto/llmserve/final_code/output/stage3b_data_prep/prepared_PLAN-TSK-002.parquet')\n\n# Discover features and target\ntarget_col = 'Production-2024-25'\nfeatures = [col for col in df.columns if col != target_col and col != 'Crop' and col != 'Season']\n\n# Split data based on year in column names\ntrain_df = df[[col for col in df.columns if int(col.split('-')[1].split('-')[0]) <= 2023]]\nX_train = train_df[features]\ny_train = train_df[target_col]\n\n# Train model\nmodel = RandomForestRegressor(n_estimators=100, random_state=42)\nmodel.fit(X_train, y_train)\n\n# Predict and evaluate\ntrain_predictions = model.predict(X_train)\nmae = mean_absolute_error(y_train, train_predictions)\nrmse = mean_squared_error(y_train, train_predictions, squared=False)\n\nprint(f\"MAE: {mae}\")\nprint(f\"RMSE: {rmse}\")",
      "libraries_required": [
        "pandas",
        "scikit-learn"
      ]
    }
  ],
  "data_split_strategy": "Train on data up to 2023-24 (columns with years \u2264 2023), validate on 2024-25",
  "date_column": "Season",
  "target_column": "Production-2024-25",
  "train_period": "2020-2023",
  "validation_period": "2024-2025",
  "test_period": null,
  "data_preprocessing_steps": [
    "Load prepared_PLAN-TSK-002.parquet using pd.read_parquet()",
    "Verify presence of 'Season' and 'Production-2024-25' columns",
    "Split data based on year in column names (train \u2264 2023, validation 2024-25)",
    "Ensure no missing values in target column",
    "Convert categorical 'Season' to dummy variables if needed"
  ]
}