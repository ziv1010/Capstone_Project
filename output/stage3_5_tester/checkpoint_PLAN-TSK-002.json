{
  "plan_id": "PLAN-TSK-002",
  "data_split_strategy": "Train: 2020-21 to 2023-24, Validation: 2024-25",
  "date_column": "derived from year in column names",
  "target_column": "Production-2024-25, Yield-2024-25",
  "train_period": "2020-21 to 2023-24",
  "validation_period": "2024-25",
  "test_period": null,
  "methods_to_test": [
    {
      "method_id": "METHOD-1",
      "name": "Moving Average Baseline",
      "description": "3-year moving average for production and yield",
      "implementation_code": "import pandas as pd\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\nimport numpy as np\n\ndef run_moving_average(df):\n    # Reshape to long format\n    df_long = pd.melt(df, id_vars=['Crop', 'Season'], \n                     value_vars=[col for col in df.columns if 'Production' in col or 'Yield' in col],\n                     var_name='year', value_name='value')\n    df_long['year'] = df_long['year'].str.split('-').str[1].astype(int)\n    \n    # Filter train data\n    train_data = df_long[df_long['year'] <= 2023]\n    \n    # Calculate moving average\n    train_data['moving_avg'] = train_data.groupby(['Crop', 'Season'])['value'].\n                               rolling(window=3, min_periods=1).mean().reset_index(level=[0,1], drop=True)\n    \n    # Get validation data\n    validation_data = df_long[df_long['year'] == 2024]\n    \n    # Merge predictions\n    predictions = validation_data.merge(\n        train_data[['Crop', 'Season', 'year', 'moving_avg']],\n        on=['Crop', 'Season'],\n        how='left'\n    )\n    \n    # Calculate metrics\n    mae = mean_absolute_error(predictions['value'], predictions['moving_avg'])\n    rmse = np.sqrt(mean_squared_error(predictions['value'], predictions['moving_avg']))\n    \n    return {\n        'mae': mae,\n        'rmse': rmse,\n        'predictions': predictions[['Crop', 'Season', 'year', 'moving_avg']].to_dict()\n    }",
      "libraries_required": [
        "pandas",
        "numpy",
        "scikit-learn"
      ]
    },
    {
      "method_id": "METHOD-2",
      "name": "SARIMA Time Series",
      "description": "Seasonal ARIMA model for time series forecasting",
      "implementation_code": "import pandas as pd\nfrom statsmodels.tsa.statespace.sarimax import SARIMAX\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\nimport numpy as np\n\ndef run_sarima(df):\n    # Reshape to long format\n    df_long = pd.melt(df, id_vars=['Crop', 'Season'], \n                     value_vars=[col for col in df.columns if 'Production' in col or 'Yield' in col],\n                     var_name='year', value_name='value')\n    df_long['year'] = df_long['year'].str.split('-').str[1].astype(int)\n    \n    # Filter train data\n    train_data = df_long[df_long['year'] <= 2023]\n    \n    # Fit SARIMA model\n    model = SARIMAX(train_data['value'],\n                   order=(1,1,1),\n                   seasonal_order=(1,1,1,1),\n                   enforce_stationarity=False,\n                   enforce_invertibility=False)\n    results = model.fit(disp=False)\n    \n    # Forecast next year\n    forecast = results.get_forecast(steps=1)\n    predictions = forecast.predicted_mean\n    \n    # Calculate metrics\n    validation_data = df_long[df_long['year'] == 2024]\n    mae = mean_absolute_error(validation_data['value'], predictions)\n    rmse = np.sqrt(mean_squared_error(validation_data['value'], predictions))\n    \n    return {\n        'mae': mae,\n        'rmse': rmse,\n        'predictions': predictions.tolist()\n    }",
      "libraries_required": [
        "pandas",
        "statsmodels",
        "scikit-learn",
        "numpy"
      ]
    },
    {
      "method_id": "METHOD-3",
      "name": "Random Forest Regressor",
      "description": "Tree-based model using historical features",
      "implementation_code": "import pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\nimport numpy as np\n\ndef run_random_forest(df):\n    # Create features\n    features = [col for col in df.columns if 'Area' in col or 'Production' in col or 'Yield' in col]\n    features = [f for f in features if '2024' not in f]  # Remove future features\n    \n    # Prepare train data\n    train_data = df.copy()\n    train_data['target_production'] = df['Production-2024-25']\n    train_data['target_yield'] = df['Yield-2024-25']\n    \n    # Train model\n    model = RandomForestRegressor(n_estimators=100, random_state=42)\n    model.fit(train_data[features], train_data['target_production'])\n    \n    # Predict\n    predictions = model.predict(train_data[features])\n    \n    # Calculate metrics\n    mae = mean_absolute_error(train_data['target_production'], predictions)\n    rmse = np.sqrt(mean_squared_error(train_data['target_production'], predictions))\n    \n    return {\n        'mae': mae,\n        'rmse': rmse,\n        'predictions': predictions.tolist()\n    }",
      "libraries_required": [
        "pandas",
        "scikit-learn"
      ]
    }
  ],
  "methods_completed": [],
  "benchmark_results": [],
  "iteration_counts": {
    "METHOD-1": 0
  },
  "created_at": "2025-11-30T16:45:35.118750",
  "updated_at": "2025-11-30T16:45:35.118792"
}